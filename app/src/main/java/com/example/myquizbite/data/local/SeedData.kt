package com.example.myquizbite.data.local

import com.example.myquizbite.data.local.entity.QuestionEntity
import com.example.myquizbite.data.local.entity.QuizEntity
import com.example.myquizbite.data.local.entity.TopicEntity
import com.example.myquizbite.data.model.Difficulty
import com.example.myquizbite.data.model.Question
import com.example.myquizbite.data.model.Quiz
import com.example.myquizbite.data.model.Topic
import org.json.JSONArray

object SeedData {

    val defaultTopics: List<Topic> = listOf(
        Topic("python", "Python", "Основы и продвинутые темы Python", "python"),
        Topic("kotlin", "Kotlin", "Язык Android-разработки", "kotlin"),
        Topic("javascript", "JavaScript", "Веб-разработка и фронтенд", "javascript"),
        Topic("sql", "SQL", "Запросы и базы данных", "database"),
        Topic("algorithms", "Алгоритмы", "Структуры данных и алгоритмы", "memory"),
        Topic("oop", "ООП", "Объектно-ориентированное программирование", "oop"),
        Topic("patterns", "Паттерны", "Паттерны проектирования GoF", "patterns"),
        Topic("git", "Git", "Система контроля версий", "git"),
        Topic("system_design", "System Design", "Проектирование систем", "system_design")
    )

    fun defaultTopicEntities(): List<TopicEntity> = defaultTopics.map { TopicEntity.from(it) }

    fun defaultQuestions(): List<QuestionEntity> = buildList {
        // ═══════════════════════════════════════════
        // PYTHON (q1 — q10)
        // ═══════════════════════════════════════════
        add(q("q1", "python", "Что выведет: print(type([]))?",
            listOf("list", "array", "tuple", "dict"), 0,
            "[] — литерал списка; type([]) возвращает <class 'list'>.", Difficulty.EASY))
        add(q("q2", "python", "Как получить последний элемент списка l?",
            listOf("l[-1]", "l.last", "l.end", "last(l)"), 0,
            "Отрицательные индексы считают с конца: -1 — последний.", Difficulty.EASY))
        add(q("q3", "python", "Что такое list comprehension?",
            listOf("Синтаксис создания списка в одну строку", "Метод списка", "Импорт из collections", "Тип данных"), 0,
            "[x*2 for x in range(5)] — создаёт список без явного цикла.", Difficulty.MEDIUM))
        add(q("q4", "python", "Чем set отличается от list?",
            listOf("Уникальные элементы, неупорядочен", "Только числа", "Нельзя добавлять", "Медленнее"), 0,
            "set — множество: уникальные, неупорядоченные, быстрый поиск.", Difficulty.MEDIUM))
        add(q("q5", "python", "Что делает __init__?",
            listOf("Конструктор экземпляра класса", "Инициализация модуля", "Деструктор", "Статический метод"), 0,
            "__init__(self) вызывается при создании объекта.", Difficulty.EASY))
        add(q("q6", "python", "Что выведет этот код?",
            listOf("2", "3", "Error", "[2]"), 0,
            "a[1] обращается ко второму элементу (индекс 1) = 2.", Difficulty.EASY,
            "a = [1, 2, 3]\nprint(a[1])"))
        add(q("q7", "python", "Что делает декоратор @staticmethod?",
            listOf("Создаёт метод без self/cls", "Делает метод приватным", "Кэширует результат", "Добавляет логирование"), 0,
            "@staticmethod убирает автоматическую передачу self или cls.", Difficulty.MEDIUM))
        add(q("q8", "python", "Чем отличается deepcopy от copy?",
            listOf("deepcopy копирует вложенные объекты", "Ничем", "copy быстрее", "deepcopy только для списков"), 0,
            "copy делает «плоскую» копию, deepcopy рекурсивно копирует все вложенные объекты.", Difficulty.HARD))
        add(q("q9", "python", "Что такое GIL в Python?",
            listOf("Глобальная блокировка интерпретатора", "Garbage Inspector Lock", "Генератор", "Компилятор"), 0,
            "GIL (Global Interpreter Lock) не позволяет выполнять >1 Python-потока на C-уровне одновременно.", Difficulty.HARD))
        add(q("q10", "python", "Что выведет код?",
            listOf("[1, 2, 3, 4]", "[1, [2, 3], 4]", "Error", "[1, 2, [3, 4]]"), 0,
            "extend() добавляет элементы итерируемого объекта по одному, а не как вложенный список.", Difficulty.MEDIUM,
            "a = [1, 2]\na.extend([3, 4])\nprint(a)"))

        // ═══════════════════════════════════════════
        // KOTLIN (q11 — q20)
        // ═══════════════════════════════════════════
        add(q("q11", "kotlin", "Чем val отличается от var?",
            listOf("val — неизменяемая, var — изменяемая", "val — число, var — строка", "Ничем", "var — константа"), 0,
            "val — read-only переменная (нельзя переприсвоить), var — можно менять.", Difficulty.EASY))
        add(q("q12", "kotlin", "Что такое data class?",
            listOf("Класс с автоматическими equals/hashCode/toString/copy", "Класс для БД", "Абстрактный класс", "Класс-синглтон"), 0,
            "data class генерирует equals(), hashCode(), toString(), copy(), componentN().", Difficulty.EASY))
        add(q("q13", "kotlin", "Что выведет код?",
            listOf("HELLO", "hello", "Error", "null"), 0,
            "?.let {} вызывается только если объект != null. Внутри it — это сама строка.", Difficulty.MEDIUM,
            "val s: String? = \"hello\"\nprintln(s?.uppercase())"))
        add(q("q14", "kotlin", "Что делает sealed class?",
            listOf("Ограничивает наследников этим файлом", "Делает класс final", "Создаёт enum", "Запрещает конструктор"), 0,
            "sealed class — все подклассы объявлены в том же файле; удобно для when без else.", Difficulty.MEDIUM))
        add(q("q15", "kotlin", "Чем object отличается от class?",
            listOf("object — синглтон", "object — абстрактный", "Ничем", "object нельзя наследовать"), 0,
            "object в Kotlin — объявление синглтона: один экземпляр на весь runtime.", Difficulty.EASY))
        add(q("q16", "kotlin", "Что такое extension function?",
            listOf("Функция, добавленная к существующему классу без наследования", "Абстрактная функция", "Lambda", "Конструктор"), 0,
            "fun String.addExclamation() = this + \"!\" — расширяет String без изменения его кода.", Difficulty.MEDIUM))
        add(q("q17", "kotlin", "Что такое coroutine?",
            listOf("Легковесный поток для асинхронного кода", "Тип коллекции", "Аннотация", "Паттерн"), 0,
            "Coroutine — приостанавливаемая функция, не блокирующая поток. Работает через suspend.", Difficulty.MEDIUM))
        add(q("q18", "kotlin", "Что выведет код?",
            listOf("[2, 4, 6]", "[1, 2, 3]", "[1, 4, 9]", "Error"), 0,
            "map{} трансформирует каждый элемент: 1*2=2, 2*2=4, 3*2=6.", Difficulty.EASY,
            "val list = listOf(1, 2, 3)\nprintln(list.map { it * 2 })"))
        add(q("q19", "kotlin", "Чем lazy отличается от lateinit?",
            listOf("lazy — инициализация при первом обращении, lateinit — позже вручную", "Ничем", "lazy только для var", "lateinit только для Int"), 0,
            "lazy {} вычисляется один раз при первом доступе (val). lateinit — для var, назначается позже.", Difficulty.HARD))
        add(q("q20", "kotlin", "Что делает inline функция?",
            listOf("Вставляет тело функции в место вызова", "Запускает в новом потоке", "Кэширует результат", "Оборачивает в try-catch"), 0,
            "inline уменьшает оверхед лямбд: компилятор вставляет код функции прямо в call-site.", Difficulty.HARD))

        // ═══════════════════════════════════════════
        // JAVASCRIPT (q21 — q30)
        // ═══════════════════════════════════════════
        add(q("q21", "javascript", "Чем let отличается от var?",
            listOf("let — блочная область видимости, var — функциональная", "Ничем", "let быстрее", "var устарел"), 0,
            "let ограничен {}-блоком, var «всплывает» до ближайшей функции.", Difficulty.EASY))
        add(q("q22", "javascript", "Что такое === в JavaScript?",
            listOf("Строгое сравнение без приведения типов", "Присваивание", "Сравнение только строк", "Ошибка"), 0,
            "=== сравнивает и значение, и тип. == приводит типы перед сравнением.", Difficulty.EASY))
        add(q("q23", "javascript", "Что выведет код?",
            listOf("undefined", "null", "0", "Error"), 0,
            "Hoisting поднимает объявление var x, но не присваивание. В момент console.log x уже существует, но = undefined.", Difficulty.MEDIUM,
            "console.log(x);\nvar x = 5;"))
        add(q("q24", "javascript", "Что такое Promise?",
            listOf("Объект, представляющий отложенный результат", "Массив", "Функция-генератор", "Тип данных"), 0,
            "Promise — обёртка над асинхронной операцией: pending → fulfilled / rejected.", Difficulty.MEDIUM))
        add(q("q25", "javascript", "Что такое closure (замыкание)?",
            listOf("Функция + ссылка на переменные внешней области", "Класс", "Цикл", "Шаблон HTML"), 0,
            "Замыкание «захватывает» переменные из окружающей области видимости.", Difficulty.MEDIUM))
        add(q("q26", "javascript", "Что выведет код?",
            listOf("string", "number", "object", "NaN"), 0,
            "typeof \"5\" возвращает \"string\", т.к. значение в кавычках — строка.", Difficulty.EASY,
            "console.log(typeof \"5\");"))
        add(q("q27", "javascript", "Что делает async/await?",
            listOf("Синтаксический сахар для работы с Promise", "Многопоточность", "Синхронный код", "Компиляция"), 0,
            "async-функция возвращает Promise; await приостанавливает выполнение до resolve.", Difficulty.MEDIUM))
        add(q("q28", "javascript", "Что такое event loop?",
            listOf("Механизм выполнения асинхронных задач в однопоточной среде", "Цикл for", "Рекурсия", "Web Worker"), 0,
            "Event loop проверяет call stack и task queue, перемещая задачи на выполнение.", Difficulty.HARD))
        add(q("q29", "javascript", "Что выведет код?",
            listOf("[1, 2, 3, 4, 5, 6]", "[1, 2, [3, 4], 5, 6]", "Error", "undefined"), 0,
            "Spread оператор (...) разворачивает элементы массива в новый массив.", Difficulty.MEDIUM,
            "const a = [1, 2];\nconst b = [...a, 3, 4, 5, 6];\nconsole.log(b);"))
        add(q("q30", "javascript", "Чем map() отличается от forEach()?",
            listOf("map() возвращает новый массив, forEach() — undefined", "Ничем", "forEach() быстрее", "map() мутирует"), 0,
            "map() создаёт новый массив с результатами; forEach() выполняет функцию, но возвращает undefined.", Difficulty.EASY))

        // ═══════════════════════════════════════════
        // SQL (q31 — q40)
        // ═══════════════════════════════════════════
        add(q("q31", "sql", "Как выбрать все колонки из таблицы users?",
            listOf("SELECT * FROM users", "GET * FROM users", "FIND users", "SELECT users.*"), 0,
            "SELECT * выбирает все колонки; FROM указывает таблицу.", Difficulty.EASY))
        add(q("q32", "sql", "Как объединить две таблицы по ключу?",
            listOf("JOIN ... ON", "MERGE", "UNION", "CONCAT"), 0,
            "JOIN ... ON связывает строки по условию равенства колонок.", Difficulty.EASY))
        add(q("q33", "sql", "Чем LEFT JOIN отличается от INNER JOIN?",
            listOf("LEFT оставляет все строки левой таблицы", "Ничем", "LEFT быстрее", "INNER не поддерживает NULL"), 0,
            "LEFT JOIN возвращает все строки левой таблицы; отсутствующие справа — NULL.", Difficulty.MEDIUM))
        add(q("q34", "sql", "Что делает GROUP BY?",
            listOf("Группирует строки для агрегации", "Сортирует", "Удаляет дубликаты", "Объединяет таблицы"), 0,
            "GROUP BY группирует строки; с ним используют COUNT, SUM, AVG.", Difficulty.MEDIUM))
        add(q("q35", "sql", "Зачем нужен индекс в БД?",
            listOf("Ускорить поиск и сортировку", "Хранить ключи", "Ограничить дубликаты", "Резервная копия"), 0,
            "Индекс ускоряет поиск (WHERE, JOIN, ORDER BY), но замедляет вставку.", Difficulty.MEDIUM))
        add(q("q36", "sql", "Чем HAVING отличается от WHERE?",
            listOf("HAVING фильтрует после GROUP BY, WHERE — до", "Ничем", "WHERE быстрее", "HAVING для JOIN"), 0,
            "WHERE фильтрует строки до группировки, HAVING — после агрегации.", Difficulty.MEDIUM))
        add(q("q37", "sql", "Что такое подзапрос (subquery)?",
            listOf("SELECT внутри другого SELECT", "Процедура", "Триггер", "Представление"), 0,
            "Подзапрос — вложенный SELECT, используемый как значение или таблица.", Difficulty.MEDIUM))
        add(q("q38", "sql", "Что делает DISTINCT?",
            listOf("Убирает дубликаты из результата", "Сортирует", "Ограничивает строки", "Объединяет"), 0,
            "SELECT DISTINCT column — возвращает только уникальные значения.", Difficulty.EASY))
        add(q("q39", "sql", "Что такое нормализация БД?",
            listOf("Устранение избыточности данных через разделение таблиц", "Шифрование", "Резервное копирование", "Индексирование"), 0,
            "Нормализация (1NF, 2NF, 3NF...) устраняет дублирование и аномалии обновления.", Difficulty.HARD))
        add(q("q40", "sql", "Что такое транзакция?",
            listOf("Набор операций, выполняемых как единое целое (ACID)", "Один запрос", "Индекс", "Триггер"), 0,
            "Транзакция: или все операции выполнены, или ни одна. ACID: Atomicity, Consistency, Isolation, Durability.", Difficulty.HARD))

        // ═══════════════════════════════════════════
        // ALGORITHMS (q41 — q50)
        // ═══════════════════════════════════════════
        add(q("q41", "algorithms", "Сложность доступа по индексу в массиве?",
            listOf("O(1)", "O(n)", "O(log n)", "O(n²)"), 0,
            "Массив хранится непрерывно в памяти — доступ по адресу = O(1).", Difficulty.EASY))
        add(q("q42", "algorithms", "Сложность бинарного поиска?",
            listOf("O(log n)", "O(n)", "O(1)", "O(n log n)"), 0,
            "На каждом шаге отбрасывается половина — логарифмическая сложность.", Difficulty.EASY))
        add(q("q43", "algorithms", "Что такое стек?",
            listOf("LIFO: последний вошёл, первый вышел", "FIFO", "Дерево", "Граф"), 0,
            "Стек: push/pop, LIFO.", Difficulty.EASY))
        add(q("q44", "algorithms", "Когда использовать хеш-таблицу?",
            listOf("Быстрый поиск по ключу O(1) в среднем", "Сортировка", "Обход дерева", "Рекурсия"), 0,
            "Hash map: O(1) для вставки, удаления, поиска.", Difficulty.MEDIUM))
        add(q("q45", "algorithms", "Что такое рекурсия?",
            listOf("Вызов функцией самой себя", "Цикл", "Параллельное выполнение", "Кэширование"), 0,
            "Рекурсия — функция вызывает себя; нужен базовый случай.", Difficulty.EASY))
        add(q("q46", "algorithms", "Сложность сортировки слиянием (Merge Sort)?",
            listOf("O(n log n)", "O(n²)", "O(n)", "O(log n)"), 0,
            "Merge Sort: делим пополам (log n уровней) × O(n) на слияние = O(n log n).", Difficulty.MEDIUM))
        add(q("q47", "algorithms", "Что такое BFS?",
            listOf("Обход графа в ширину (по уровням, очередь)", "Обход в глубину", "Сортировка", "Поиск подстроки"), 0,
            "BFS (Breadth-First Search) использует очередь для обхода по уровням.", Difficulty.MEDIUM))
        add(q("q48", "algorithms", "Что такое динамическое программирование?",
            listOf("Разбиение задачи на подзадачи с запоминанием результатов", "Рекурсия без кэша", "Жадный алгоритм", "Сортировка"), 0,
            "DP решает перекрывающиеся подзадачи, сохраняя результаты (мемоизация/табуляция).", Difficulty.HARD))
        add(q("q49", "algorithms", "Сложность быстрой сортировки (Quick Sort) в среднем?",
            listOf("O(n log n)", "O(n²)", "O(n)", "O(log n)"), 0,
            "В среднем O(n log n), но в худшем O(n²) при плохом выборе pivot.", Difficulty.MEDIUM))
        add(q("q50", "algorithms", "Что такое Big O нотация?",
            listOf("Верхняя граница роста времени/памяти алгоритма", "Точное время", "Минимальная сложность", "Размер входа"), 0,
            "Big O описывает, как растёт время/память при росте входных данных (асимптотика).", Difficulty.EASY))

        // ═══════════════════════════════════════════
        // ООП (q51 — q58)
        // ═══════════════════════════════════════════
        add(q("q51", "oop", "Назовите 4 основных принципа ООП.",
            listOf("Инкапсуляция, наследование, полиморфизм, абстракция", "DRY, KISS, YAGNI, SOLID", "Модульность, типизация, конкурентность, безопасность", "MVC, MVP, MVVM, MVI"), 0,
            "Четыре столпа ООП: инкапсуляция, наследование, полиморфизм, абстракция.", Difficulty.EASY))
        add(q("q52", "oop", "Что такое инкапсуляция?",
            listOf("Скрытие деталей реализации за публичным интерфейсом", "Наследование", "Создание объектов", "Многопоточность"), 0,
            "Инкапсуляция: данные + методы в одном классе; доступ через public API.", Difficulty.EASY))
        add(q("q53", "oop", "Чем абстрактный класс отличается от интерфейса?",
            listOf("Абстрактный класс может иметь состояние и реализацию методов", "Ничем", "Интерфейс быстрее", "Абстрактный класс нельзя наследовать"), 0,
            "Абстрактный класс: поля + реализация + абстрактные методы. Интерфейс: контракт (в Kotlin/Java можно default методы).", Difficulty.MEDIUM))
        add(q("q54", "oop", "Что такое полиморфизм?",
            listOf("Один интерфейс, разные реализации", "Множественное наследование", "Статическая типизация", "Компиляция"), 0,
            "Полиморфизм: вызов метода определяется типом объекта в runtime (dynamic dispatch).", Difficulty.EASY))
        add(q("q55", "oop", "Что означает принцип SOLID — S (SRP)?",
            listOf("Класс должен иметь одну причину для изменения", "Класс должен быть маленьким", "Синглтон", "Статический класс"), 0,
            "Single Responsibility Principle: каждый класс отвечает за одну зону ответственности.", Difficulty.MEDIUM))
        add(q("q56", "oop", "Что такое Dependency Injection?",
            listOf("Передача зависимостей извне, а не создание внутри класса", "Наследование", "Синглтон", "Фабрика"), 0,
            "DI: зависимости передаются через конструктор/метод, а не создаются внутри. Уменьшает связанность.", Difficulty.MEDIUM))
        add(q("q57", "oop", "Чем композиция отличается от наследования?",
            listOf("Композиция: «имеет», наследование: «является»", "Ничем", "Наследование быстрее", "Композиция — это интерфейс"), 0,
            "Композиция — включение объекта внутрь другого (has-a). Наследование — is-a. Предпочитайте композицию.", Difficulty.MEDIUM))
        add(q("q58", "oop", "Что такое Liskov Substitution Principle?",
            listOf("Подтип должен быть заменяем базовым типом без нарушения программы", "Принцип единственной ответственности", "Инверсия зависимостей", "Открытость/закрытость"), 0,
            "LSP: если B наследует A, то B можно подставить вместо A без ошибок.", Difficulty.HARD))

        // ═══════════════════════════════════════════
        // PATTERNS (q59 — q66)
        // ═══════════════════════════════════════════
        add(q("q59", "patterns", "Что делает паттерн Singleton?",
            listOf("Гарантирует один экземпляр класса на всю программу", "Создаёт семейство объектов", "Наблюдает за событиями", "Оборачивает объект"), 0,
            "Singleton: ровно один объект; глобальная точка доступа. В Kotlin — object.", Difficulty.EASY))
        add(q("q60", "patterns", "Что делает паттерн Observer?",
            listOf("Уведомляет подписчиков об изменении состояния", "Создаёт объект", "Скрывает сложность", "Адаптирует интерфейс"), 0,
            "Observer (Наблюдатель): субъект оповещает наблюдателей при изменении. Пример: LiveData, Flow.", Difficulty.MEDIUM))
        add(q("q61", "patterns", "Что делает паттерн Factory Method?",
            listOf("Делегирует создание объектов подклассам", "Клонирует объект", "Добавляет поведение", "Уведомляет подписчиков"), 0,
            "Factory Method: базовый класс определяет интерфейс создания; подклассы решают, какой объект создать.", Difficulty.MEDIUM))
        add(q("q62", "patterns", "Что делает паттерн Strategy?",
            listOf("Инкапсулирует алгоритм и позволяет менять его в runtime", "Создаёт объект", "Сохраняет состояние", "Обходит дерево"), 0,
            "Strategy: семейство алгоритмов за общим интерфейсом; клиент выбирает нужный.", Difficulty.MEDIUM))
        add(q("q63", "patterns", "Что делает паттерн Adapter?",
            listOf("Преобразует интерфейс класса в ожидаемый клиентом", "Создаёт копию", "Уведомляет", "Ограничивает доступ"), 0,
            "Adapter (Адаптер): оборачивает класс, чтобы он соответствовал нужному интерфейсу.", Difficulty.EASY))
        add(q("q64", "patterns", "Что делает паттерн Decorator?",
            listOf("Динамически добавляет новое поведение объекту", "Создаёт объект", "Ограничивает доступ", "Клонирует"), 0,
            "Decorator оборачивает объект, добавляя поведение без изменения класса.", Difficulty.MEDIUM))
        add(q("q65", "patterns", "Что делает паттерн Builder?",
            listOf("Пошагово конструирует сложный объект", "Наблюдает за событиями", "Адаптирует интерфейс", "Копирует объект"), 0,
            "Builder: разделяет конструирование и представление. Полезен при >3 параметрах.", Difficulty.EASY))
        add(q("q66", "patterns", "К какой категории относится паттерн MVC?",
            listOf("Архитектурный (не GoF)", "Порождающий", "Структурный", "Поведенческий"), 0,
            "MVC (Model-View-Controller) — архитектурный паттерн для разделения UI и логики.", Difficulty.MEDIUM))

        // ═══════════════════════════════════════════
        // GIT (q67 — q74)
        // ═══════════════════════════════════════════
        add(q("q67", "git", "Что делает git add?",
            listOf("Добавляет изменения в staging area (индекс)", "Коммитит", "Пушит на сервер", "Удаляет файл"), 0,
            "git add перемещает изменения из working directory в staging area.", Difficulty.EASY))
        add(q("q68", "git", "Чем git merge отличается от git rebase?",
            listOf("merge создаёт merge-commit, rebase перемещает коммиты", "Ничем", "rebase удаляет ветку", "merge быстрее"), 0,
            "merge сохраняет историю слияния; rebase линейно переносит коммиты поверх другой ветки.", Difficulty.MEDIUM))
        add(q("q69", "git", "Что делает git stash?",
            listOf("Временно сохраняет незакоммиченные изменения", "Удаляет ветку", "Пушит", "Откатывает коммит"), 0,
            "git stash «прячет» изменения, чтобы переключиться на другую задачу.", Difficulty.EASY))
        add(q("q70", "git", "Что такое git cherry-pick?",
            listOf("Применяет конкретный коммит из другой ветки", "Удаляет коммит", "Создаёт ветку", "Сливает ветки"), 0,
            "cherry-pick копирует один коммит (по хешу) в текущую ветку.", Difficulty.MEDIUM))
        add(q("q71", "git", "Что делает git reset --hard HEAD~1?",
            listOf("Откатывает последний коммит, удаляя изменения", "Создаёт новый коммит", "Пушит", "Мержит"), 0,
            "--hard удаляет коммит и все изменения (working + staging). Осторожно!", Difficulty.HARD))
        add(q("q72", "git", "Что такое .gitignore?",
            listOf("Файл с шаблонами файлов, которые Git игнорирует", "Конфиг сервера", "Лог Git", "Файл блокировки"), 0,
            ".gitignore указывает, какие файлы/директории не отслеживать (node_modules, .env и т.д.).", Difficulty.EASY))
        add(q("q73", "git", "Что такое pull request (PR)?",
            listOf("Запрос на слияние ветки с обзором кода", "Команда git", "Клонирование репо", "Ребейз"), 0,
            "PR (GitHub) / MR (GitLab) — запрос влить ветку в основную с code review.", Difficulty.EASY))
        add(q("q74", "git", "Как отменить последний коммит, сохранив изменения?",
            listOf("git reset --soft HEAD~1", "git reset --hard HEAD~1", "git revert HEAD", "git stash"), 0,
            "--soft откатывает коммит, но оставляет изменения в staging area.", Difficulty.MEDIUM))

        // ═══════════════════════════════════════════
        // SYSTEM DESIGN (q75 — q80)
        // ═══════════════════════════════════════════
        add(q("q75", "system_design", "Что такое горизонтальное масштабирование?",
            listOf("Добавление новых серверов/узлов", "Увеличение CPU/RAM одного сервера", "Кэширование", "Репликация БД"), 0,
            "Horizontal scaling (scale out): больше машин. Vertical (scale up): мощнее одна машина.", Difficulty.EASY))
        add(q("q76", "system_design", "Зачем нужен Load Balancer?",
            listOf("Распределяет трафик между серверами", "Шифрует данные", "Хранит сессии", "Кэширует запросы"), 0,
            "Load Balancer распределяет запросы (round-robin, least connections и т.д.) для равномерной нагрузки.", Difficulty.MEDIUM))
        add(q("q77", "system_design", "Что такое CAP-теорема?",
            listOf("Нельзя одновременно гарантировать Consistency, Availability и Partition tolerance", "Аббревиатура для кэша", "Принцип ООП", "Тип базы данных"), 0,
            "CAP: в распределённой системе при network partition выбирают между C и A.", Difficulty.HARD))
        add(q("q78", "system_design", "Зачем нужен кэш (Redis, Memcached)?",
            listOf("Уменьшить время ответа и нагрузку на БД", "Заменить БД", "Для авторизации", "Для логирования"), 0,
            "Кэш хранит часто запрашиваемые данные в памяти: O(1) доступ, снижает нагрузку на хранилище.", Difficulty.MEDIUM))
        add(q("q79", "system_design", "Что такое микросервисная архитектура?",
            listOf("Система из маленьких независимых сервисов", "Один большой сервис", "Клиент-серверная модель", "Шаблон MVC"), 0,
            "Микросервисы: каждый сервис отвечает за свою domain-область, деплоится и масштабируется отдельно.", Difficulty.MEDIUM))
        add(q("q80", "system_design", "Что такое REST API?",
            listOf("Архитектурный стиль: HTTP-методы + ресурсы + stateless", "Протокол передачи файлов", "Язык запросов", "База данных"), 0,
            "REST: GET/POST/PUT/DELETE на URL-ресурсы; stateless; JSON/XML ответы.", Difficulty.EASY))

        // ═══════════════════════════════════════════
        // PYTHON (q81 — q90)
        // ═══════════════════════════════════════════
        add(q("q81", "python", "Что такое lambda в Python?",
            listOf("Анонимная функция", "Тип данных", "Модуль", "Оператор"), 0,
            "lambda — анонимная функция: lambda x: x*2. Используется для коротких выражений.", Difficulty.EASY))
        add(q("q82", "python", "Что выведет код?",
            listOf("3", "4", "Error", "2"), 0,
            "set хранит уникальные элементы; add(2) не добавит дубликат — len=3.", Difficulty.MEDIUM,
            "x = {1, 2, 3}\nx.add(2)\nprint(len(x))"))
        add(q("q83", "python", "Что делает yield?",
            listOf("Превращает функцию в генератор", "Завершает программу", "Создаёт поток", "Вызывает исключение"), 0,
            "yield приостанавливает функцию и возвращает значение; при следующем вызове продолжает.", Difficulty.MEDIUM))
        add(q("q84", "python", "Чем tuple отличается от list?",
            listOf("tuple неизменяемый", "tuple быстрее при вставке", "list нельзя сортировать", "Ничем"), 0,
            "tuple — immutable: нельзя менять после создания. Используется как ключ dict.", Difficulty.EASY))
        add(q("q85", "python", "Что такое *args и **kwargs?",
            listOf("args — позиционные, kwargs — именованные аргументы произвольной длины", "Типы данных", "Операторы", "Методы строк"), 0,
            "*args собирает позиционные аргументы в tuple; **kwargs — именованные в dict.", Difficulty.MEDIUM))
        add(q("q86", "python", "Что выведет код?",
            listOf("False True False", "True True True", "False False False", "True False True"), 0,
            "Пустая строка и пустой список — False; '0' — непустая строка → True.", Difficulty.HARD,
            "print(bool(''), bool('0'), bool([]))"))
        add(q("q87", "python", "Что такое контекстный менеджер (with)?",
            listOf("Автоматически управляет ресурсами (open/close)", "Цикл", "Условие", "Исключение"), 0,
            "with open('file') as f: — гарантирует закрытие файла даже при ошибке.", Difficulty.MEDIUM))
        add(q("q88", "python", "Чем is отличается от ==?",
            listOf("is — идентичность объектов, == — равенство значений", "Ничем", "is для строк, == для чисел", "is быстрее"), 0,
            "is проверяет, что объекты в памяти одинаковые (id). == проверяет значение.", Difficulty.MEDIUM))
        add(q("q89", "python", "Что делает enumerate()?",
            listOf("Возвращает индекс и значение при итерации", "Считает элементы", "Сортирует", "Фильтрует"), 0,
            "for i, val in enumerate(lst): — удобная итерация с индексами.", Difficulty.EASY))
        add(q("q90", "python", "Что такое дескрипторы в Python?",
            listOf("Объекты с __get__, __set__, __delete__", "Типы данных", "Декораторы", "Модули"), 0,
            "Дескрипторы управляют доступом к атрибутам. property — пример дескриптора.", Difficulty.HARD))

        // ═══════════════════════════════════════════
        // KOTLIN (q91 — q100)
        // ═══════════════════════════════════════════
        add(q("q91", "kotlin", "Что такое scope function let?",
            listOf("Выполняет блок с объектом как it, если не null", "Создаёт новый объект", "Цикл", "Исключение"), 0,
            "obj?.let { ... } — безопасно вызовет блок только если obj != null.", Difficulty.EASY))
        add(q("q92", "kotlin", "Что выведет код?",
            listOf("[2, 3]", "[1, 2, 3]", "[1]", "Error"), 0,
            "filter оставляет элементы, для которых условие true: 2>1 и 3>1.", Difficulty.EASY,
            "val x = listOf(1,2,3).filter { it > 1 }\nprintln(x)"))
        add(q("q93", "kotlin", "Что такое companion object?",
            listOf("Объект-компаньон: аналог static в Java", "Конструктор", "Абстрактный класс", "Интерфейс"), 0,
            "companion object — синглтон внутри класса; хранит «статические» члены.", Difficulty.MEDIUM))
        add(q("q94", "kotlin", "Чем when отличается от switch (Java)?",
            listOf("when — мощнее: поддерживает диапазоны, типы, произвольные условия", "Ничем", "when медленнее", "switch поддерживает больше типов"), 0,
            "when может проверять is Type, in 1..10, произвольные булевые выражения.", Difficulty.MEDIUM))
        add(q("q95", "kotlin", "Что такое Flow в Kotlin?",
            listOf("Холодный асинхронный поток данных", "Коллекция", "Аннотация", "Тип Exception"), 0,
            "Flow — реактивный поток: emit() отправляет, collect {} получает значения.", Difficulty.MEDIUM))
        add(q("q96", "kotlin", "Что выведет код?",
            listOf("3", "12", "Pair(1,2)", "Error"), 0,
            "Деструктуризация: Pair(1,2) раскладывается в a=1, b=2; a+b=3.", Difficulty.EASY,
            "val (a, b) = Pair(1, 2)\nprintln(a + b)"))
        add(q("q97", "kotlin", "Что делает apply в Kotlin?",
            listOf("Вызывает блок с this, возвращает сам объект", "Создаёт копию", "Фильтрует", "Выбрасывает исключение"), 0,
            "apply {} — scope function для конфигурации объекта; возвращает this.", Difficulty.MEDIUM))
        add(q("q98", "kotlin", "Что такое reified в inline функции?",
            listOf("Позволяет использовать тип-параметр в runtime", "Делает функцию приватной", "Кэширует", "Запускает в потоке"), 0,
            "reified + inline позволяет проверять T::class в runtime, что обычно стирается.", Difficulty.HARD))
        add(q("q99", "kotlin", "Чем Sequence отличается от List?",
            listOf("Sequence вычисляет элементы лениво", "Ничем", "List быстрее", "Sequence — изменяемый"), 0,
            "Sequence обрабатывает элементы по одному (lazy); List — весь набор сразу (eager).", Difficulty.MEDIUM))
        add(q("q100", "kotlin", "Что такое delegation в Kotlin (by)?",
            listOf("Делегирование реализации интерфейса другому объекту", "Наследование", "Аннотация", "Цикл"), 0,
            "class A(b: B) : Interface by b — делегирует вызовы Interface объекту b.", Difficulty.HARD))

        // ═══════════════════════════════════════════
        // JAVASCRIPT (q101 — q110)
        // ═══════════════════════════════════════════
        add(q("q101", "javascript", "Что такое this в JavaScript?",
            listOf("Контекст выполнения, зависит от способа вызова", "Глобальная переменная", "Ключевое слово для циклов", "Тип данных"), 0,
            "this определяется в момент вызова: в методе — объект, в arrow — лексический контекст.", Difficulty.MEDIUM))
        add(q("q102", "javascript", "Что выведет код?",
            listOf("true false", "false false", "true true", "false true"), 0,
            "== приводит типы: [] → '' → 0, false → 0, 0==0 → true. === не приводит → false.", Difficulty.HARD,
            "console.log([] == false);\nconsole.log([] === false);"))
        add(q("q103", "javascript", "Что такое prototype?",
            listOf("Механизм наследования в JS: каждый объект имеет прототип", "Метод массива", "Тип данных", "Модуль"), 0,
            "Все объекты наследуют свойства через цепочку прототипов (__proto__).", Difficulty.MEDIUM))
        add(q("q104", "javascript", "Что делает Object.freeze()?",
            listOf("Запрещает изменение свойств объекта", "Удаляет объект", "Копирует", "Сортирует"), 0,
            "freeze делает объект immutable: нельзя добавлять, удалять, менять свойства.", Difficulty.MEDIUM))
        add(q("q105", "javascript", "Что такое destructuring?",
            listOf("Распаковка свойств объекта/массива в переменные", "Удаление свойств", "Клонирование", "Компиляция"), 0,
            "const {name, age} = obj; или const [a, b] = arr; — удобный синтаксис.", Difficulty.EASY))
        add(q("q106", "javascript", "Что выведет код?",
            listOf("2 2", "1 2", "2 1", "1 1"), 0,
            "Синхронный код (x=2, log(x)→2) выполняется раньше setTimeout (макротаск)→ log(2).", Difficulty.HARD,
            "let x = 1;\nsetTimeout(() => console.log(x), 0);\nx = 2;\nconsole.log(x);"))
        add(q("q107", "javascript", "Чем null отличается от undefined?",
            listOf("null — явное отсутствие, undefined — не задано", "Ничем", "null — для чисел", "undefined — ошибка"), 0,
            "undefined: переменная объявлена, но нет значения. null: разработчик явно указал «пусто».", Difficulty.EASY))
        add(q("q108", "javascript", "Что такое WeakMap?",
            listOf("Map, не мешающий GC удалять ключи", "Массив", "Строка", "Быстрый Map"), 0,
            "WeakMap хранит объекты-ключи «слабо»: если нет других ссылок, GC удалит.", Difficulty.HARD))
        add(q("q109", "javascript", "Что делает Array.reduce()?",
            listOf("Сворачивает массив в одно значение через аккумулятор", "Фильтрует", "Сортирует", "Копирует"), 0,
            "[1,2,3].reduce((acc, x) => acc + x, 0) → 6. Аккумулирует значение.", Difficulty.MEDIUM))
        add(q("q110", "javascript", "Что такое Symbol?",
            listOf("Уникальный и неизменяемый примитив для ключей", "Тип массива", "Оператор", "Модуль"), 0,
            "Symbol() создаёт гарантированно уникальное значение; используется как ключ свойства.", Difficulty.HARD))

        // ═══════════════════════════════════════════
        // SQL (q111 — q118)
        // ═══════════════════════════════════════════
        add(q("q111", "sql", "Что делает UNION?",
            listOf("Объединяет результаты двух SELECT без дубликатов", "Пересекает", "Вычитает", "Умножает"), 0,
            "UNION удаляет дубликаты. UNION ALL оставляет все строки.", Difficulty.MEDIUM))
        add(q("q112", "sql", "Что такое VIEW?",
            listOf("Виртуальная таблица на основе запроса", "Индекс", "Триггер", "Процедура"), 0,
            "VIEW: CREATE VIEW v AS SELECT ... — сохранённый запрос как виртуальная таблица.", Difficulty.MEDIUM))
        add(q("q113", "sql", "Что такое PRIMARY KEY?",
            listOf("Уникальный идентификатор строки таблицы", "Внешний ключ", "Индекс", "Триггер"), 0,
            "PRIMARY KEY: уникален + NOT NULL; одна строка — один ключ.", Difficulty.EASY))
        add(q("q114", "sql", "Что делает COALESCE()?",
            listOf("Возвращает первый не-NULL аргумент", "Считает строки", "Сортирует", "Группирует"), 0,
            "COALESCE(a, b, c) вернёт первое значение, которое не NULL.", Difficulty.MEDIUM))
        add(q("q115", "sql", "Что такое FOREIGN KEY?",
            listOf("Ссылка на PRIMARY KEY другой таблицы", "Уникальный ключ", "Индекс", "Представление"), 0,
            "FOREIGN KEY обеспечивает ссылочную целостность: значение должно существовать в связанной таблице.", Difficulty.EASY))
        add(q("q116", "sql", "Что делает DELETE vs TRUNCATE?",
            listOf("DELETE — по строкам с WHERE, TRUNCATE — все строки без лога", "Ничем", "TRUNCATE медленнее", "DELETE не поддерживает WHERE"), 0,
            "DELETE пишет лог для каждой строки (можно откатить). TRUNCATE быстрее, но без WHERE.", Difficulty.HARD))
        add(q("q117", "sql", "Что такое оконная функция (OVER)?",
            listOf("Вычисление по набору строк без группировки", "Подзапрос", "JOIN", "Триггер"), 0,
            "ROW_NUMBER() OVER(PARTITION BY x ORDER BY y) — нумерует строки внутри группы.", Difficulty.HARD))
        add(q("q118", "sql", "Чем CHAR отличается от VARCHAR?",
            listOf("CHAR — фиксированная длина, VARCHAR — переменная", "Ничем", "VARCHAR медленнее", "CHAR только для чисел"), 0,
            "CHAR(10) всегда 10 символов (с пробелами). VARCHAR(10) — до 10, по факту.", Difficulty.EASY))

        // ═══════════════════════════════════════════
        // ALGORITHMS (q119 — q128)
        // ═══════════════════════════════════════════
        add(q("q119", "algorithms", "Что такое очередь (Queue)?",
            listOf("FIFO: первый вошёл, первый вышел", "LIFO", "Дерево", "Граф"), 0,
            "Queue: enqueue/dequeue; первый добавленный элемент извлекается первым.", Difficulty.EASY))
        add(q("q120", "algorithms", "Сложность вставки в конец ArrayList?",
            listOf("O(1) амортизированная", "O(n)", "O(log n)", "O(n²)"), 0,
            "Обычно O(1); при расширении массива O(n), но амортизированно — O(1).", Difficulty.MEDIUM))
        add(q("q121", "algorithms", "Что такое DFS?",
            listOf("Обход графа в глубину (стек/рекурсия)", "Обход в ширину", "Сортировка", "Поиск подстроки"), 0,
            "DFS (Depth-First Search) идёт вглубь до тупика, затем возвращается.", Difficulty.MEDIUM))
        add(q("q122", "algorithms", "Сложность поиска в BST (сбалансированном)?",
            listOf("O(log n)", "O(n)", "O(1)", "O(n²)"), 0,
            "В сбалансированном BST (AVL, Red-Black) высота = log n → поиск O(log n).", Difficulty.MEDIUM))
        add(q("q123", "algorithms", "Что такое жадный алгоритм?",
            listOf("На каждом шаге выбирает локально лучшее решение", "Полный перебор", "Рекурсия", "Динамическое программирование"), 0,
            "Greedy: оптимальный выбор на каждом шаге. Не всегда даёт глобальный оптимум.", Difficulty.MEDIUM))
        add(q("q124", "algorithms", "Что такое linked list?",
            listOf("Цепочка узлов, каждый указывает на следующий", "Массив", "Стек", "Хеш-таблица"), 0,
            "Linked list: узлы с данными + ссылка на следующий. Вставка/удаление O(1) при известном узле.", Difficulty.EASY))
        add(q("q125", "algorithms", "Сложность сортировки пузырьком?",
            listOf("O(n²)", "O(n log n)", "O(n)", "O(log n)"), 0,
            "Bubble sort: два вложенных цикла, на каждом шаге пара сравнений → O(n²).", Difficulty.EASY))
        add(q("q126", "algorithms", "Что такое граф?",
            listOf("Набор вершин и рёбер между ними", "Массив", "Стек", "Дерево без циклов"), 0,
            "Граф G = (V, E): вершины и рёбра. Может быть ориентированным, взвешенным.", Difficulty.EASY))
        add(q("q127", "algorithms", "Что такое мемоизация?",
            listOf("Кэширование результатов функции", "Сортировка", "Обход графа", "Параллелизм"), 0,
            "Мемоизация: при повторном вызове с теми же аргументами — возвращает кэш.", Difficulty.MEDIUM))
        add(q("q128", "algorithms", "Сложность поиска элемента в hash set?",
            listOf("O(1) в среднем", "O(n)", "O(log n)", "O(n²)"), 0,
            "Hash set: хеш-функция определяет бакет → поиск за O(1) амортизированно.", Difficulty.EASY))

        // ═══════════════════════════════════════════
        // ООП (q129 — q134)
        // ═══════════════════════════════════════════
        add(q("q129", "oop", "Что такое Open/Closed Principle (SOLID O)?",
            listOf("Открыт для расширения, закрыт для модификации", "Один класс — одна задача", "Инверсия зависимостей", "Подстановка Лисков"), 0,
            "OCP: добавляйте новое поведение через наследование/композицию, не меняя существующий код.", Difficulty.MEDIUM))
        add(q("q130", "oop", "Что такое Interface Segregation (SOLID I)?",
            listOf("Много узких интерфейсов лучше одного большого", "Один интерфейс на всё", "Инверсия", "Единственная ответственность"), 0,
            "ISP: клиент не должен зависеть от методов, которые не использует.", Difficulty.MEDIUM))
        add(q("q131", "oop", "Что такое Dependency Inversion (SOLID D)?",
            listOf("Зависимость от абстракций, а не от реализаций", "Инъекция зависимостей", "Синглтон", "Фабрика"), 0,
            "DIP: высокоуровневые модули зависят от абстракций; детали реализуют абстракции.", Difficulty.HARD))
        add(q("q132", "oop", "Что такое множественное наследование?",
            listOf("Класс наследует от нескольких родителей", "Один родитель", "Интерфейс", "Композиция"), 0,
            "В Java/Kotlin нет множественного наследования классов, но есть интерфейсы.", Difficulty.MEDIUM))
        add(q("q133", "oop", "Что такое перегрузка метода (overloading)?",
            listOf("Несколько методов с одним именем, но разными параметрами", "Переопределение в подклассе", "Создание интерфейса", "Инкапсуляция"), 0,
            "Overloading: компилятор выбирает метод по типам/числу аргументов.", Difficulty.EASY))
        add(q("q134", "oop", "Что такое переопределение (overriding)?",
            listOf("Подкласс заменяет реализацию метода родителя", "Перегрузка", "Инкапсуляция", "Абстракция"), 0,
            "Override: подкласс предоставляет свою реализацию метода суперкласса.", Difficulty.EASY))

        // ═══════════════════════════════════════════
        // PATTERNS (q135 — q140)
        // ═══════════════════════════════════════════
        add(q("q135", "patterns", "Что делает паттерн Proxy?",
            listOf("Контролирует доступ к объекту через заместителя", "Создаёт объект", "Наблюдает", "Адаптирует"), 0,
            "Proxy: перехватывает обращения к объекту (кэширование, проверка прав, ленивая загрузка).", Difficulty.MEDIUM))
        add(q("q136", "patterns", "Что делает паттерн Facade?",
            listOf("Предоставляет упрощённый интерфейс к сложной подсистеме", "Создаёт копию", "Адаптирует", "Наблюдает"), 0,
            "Facade: один класс скрывает сложность подсистемы за простым API.", Difficulty.EASY))
        add(q("q137", "patterns", "Что делает паттерн Command?",
            listOf("Инкапсулирует запрос как объект для undo/redo/логирования", "Создаёт объект", "Наблюдает за событиями", "Адаптирует интерфейс"), 0,
            "Command: execute()/undo() — позволяет откатывать действия, создавать очереди.", Difficulty.MEDIUM))
        add(q("q138", "patterns", "Что делает паттерн Template Method?",
            listOf("Определяет скелет алгоритма, подклассы переопределяют шаги", "Создаёт объект", "Наблюдает", "Оборачивает"), 0,
            "Template Method: базовый класс задаёт порядок шагов; подклассы реализуют детали.", Difficulty.MEDIUM))
        add(q("q139", "patterns", "Что делает паттерн State?",
            listOf("Объект меняет поведение при изменении состояния", "Создаёт объект", "Клонирует", "Наблюдает"), 0,
            "State: объект делегирует поведение текущему объекту-состоянию. Меняется «класс» объекта.", Difficulty.HARD))
        add(q("q140", "patterns", "Что делает паттерн Composite?",
            listOf("Группирует объекты в древовидную структуру", "Создаёт копию", "Адаптирует", "Наблюдает"), 0,
            "Composite: единообразная работа с одиночными объектами и группами (дерево).", Difficulty.MEDIUM))

        // ═══════════════════════════════════════════
        // GIT (q141 — q146)
        // ═══════════════════════════════════════════
        add(q("q141", "git", "Что такое git branch?",
            listOf("Команда для создания/просмотра веток", "Удаление файла", "Коммит", "Клонирование"), 0,
            "git branch name создаёт ветку; git branch — список веток.", Difficulty.EASY))
        add(q("q142", "git", "Что делает git fetch?",
            listOf("Скачивает изменения с remote, не сливая", "Пушит", "Мержит", "Удаляет"), 0,
            "fetch обновляет локальные ссылки на remote, но не изменяет рабочую директорию.", Difficulty.MEDIUM))
        add(q("q143", "git", "Что такое git revert?",
            listOf("Создаёт новый коммит, отменяющий изменения указанного", "Удаляет коммит", "Мержит", "Стэшит"), 0,
            "revert безопасно отменяет коммит: история сохраняется + новый отменяющий коммит.", Difficulty.MEDIUM))
        add(q("q144", "git", "Что такое git tag?",
            listOf("Метка для конкретного коммита (обычно для релизов)", "Ветка", "Remote", "Stash"), 0,
            "git tag v1.0 — создаёт тег. Обычно используется для обозначения версий.", Difficulty.EASY))
        add(q("q145", "git", "Что такое git submodule?",
            listOf("Вложенный репозиторий внутри родительского", "Ветка", "Тег", "Stash"), 0,
            "submodule позволяет включить один Git-репозиторий как подпапку другого.", Difficulty.HARD))
        add(q("q146", "git", "Чем git pull отличается от git fetch?",
            listOf("pull = fetch + merge", "Ничем", "pull только скачивает", "fetch мержит"), 0,
            "git pull — это git fetch + git merge. fetch только скачивает.", Difficulty.EASY))

        // ═══════════════════════════════════════════
        // SYSTEM DESIGN (q147 — q155)
        // ═══════════════════════════════════════════
        add(q("q147", "system_design", "Что такое CDN?",
            listOf("Сеть серверов для доставки контента близко к пользователю", "База данных", "Протокол", "Балансировщик"), 0,
            "CDN (Content Delivery Network) кэширует статику на edge-серверах по всему миру.", Difficulty.EASY))
        add(q("q148", "system_design", "Что такое шардирование (sharding)?",
            listOf("Горизонтальное разделение данных по серверам", "Вертикальное разделение", "Репликация", "Кэширование"), 0,
            "Sharding: данные распределяются по ключу между несколькими БД-серверами.", Difficulty.HARD))
        add(q("q149", "system_design", "Что такое message queue (Kafka, RabbitMQ)?",
            listOf("Асинхронная очередь для обмена сообщениями между сервисами", "База данных", "Кэш", "Балансировщик"), 0,
            "MQ разделяет производителя и потребителя; обеспечивает надёжную доставку.", Difficulty.MEDIUM))
        add(q("q150", "system_design", "Что такое API Gateway?",
            listOf("Единая точка входа для всех API-запросов", "База данных", "Кэш", "Очередь"), 0,
            "API Gateway: маршрутизация, аутентификация, rate limiting, агрегация запросов.", Difficulty.MEDIUM))
        add(q("q151", "system_design", "Что такое rate limiting?",
            listOf("Ограничение количества запросов от клиента за период", "Балансировка", "Шифрование", "Кэширование"), 0,
            "Rate limiting защищает от DDoS и abuse: например, 100 запросов/минуту.", Difficulty.MEDIUM))
        add(q("q152", "system_design", "Что такое eventual consistency?",
            listOf("Данные станут согласованными через некоторое время", "Мгновенная согласованность", "Кэширование", "Шардирование"), 0,
            "В распределённых системах обновление распространяется не мгновенно, но гарантированно.", Difficulty.HARD))
        add(q("q153", "system_design", "Что такое WebSocket?",
            listOf("Двунаправленное соединение для real-time обмена", "HTTP запрос", "FTP", "SMTP"), 0,
            "WebSocket: одно TCP-соединение, через которое сервер и клиент обмениваются данными.", Difficulty.MEDIUM))
        add(q("q154", "system_design", "Что такое OAuth 2.0?",
            listOf("Протокол авторизации через токены", "Шифрование", "Балансировка", "Хеширование"), 0,
            "OAuth 2.0: клиент получает access token для доступа к ресурсам от имени пользователя.", Difficulty.MEDIUM))
        add(q("q155", "system_design", "Что такое SQL vs NoSQL?",
            listOf("SQL — реляционные таблицы, NoSQL — документы/ключи/графы", "Ничем", "NoSQL быстрее", "SQL устарел"), 0,
            "SQL: строгая схема, JOIN, ACID. NoSQL: гибкая схема, горизонтальное масштабирование.", Difficulty.EASY))
    }.map { it.toEntity() }

    private fun q(id: String, topicId: String, text: String, options: List<String>, correct: Int, explanation: String, difficulty: Difficulty, code: String? = null): Question =
        Question(id, topicId, text, options, correct, explanation, difficulty, code)

    private fun Question.toEntity(): QuestionEntity = QuestionEntity(
        id = id, topicId = topicId, text = text,
        optionsJson = JSONArray(options).toString(),
        correctIndex = correctIndex, explanation = explanation, difficulty = difficulty.name, codeSnippet = codeSnippet
    )

    fun defaultQuizzes(): List<QuizEntity> = listOf(
        // Python
        Quiz("quiz-py-easy", "python", "Python: основы", "Типы, список, конструктор", Difficulty.EASY, listOf("q1","q2","q5","q6"), 60, false),
        Quiz("quiz-py-mid", "python", "Python: средний уровень", "Comprehension, set, декораторы", Difficulty.MEDIUM, listOf("q3","q4","q7","q10"), 90, false),
        Quiz("quiz-py-hard", "python", "Python: продвинутый", "deepcopy, GIL, декораторы", Difficulty.HARD, listOf("q8","q9","q7","q3"), 120, false),
        Quiz("quiz-py-easy2", "python", "Python: типы данных", "lambda, tuple, enum, bool", Difficulty.EASY, listOf("q81","q84","q89","q82"), 60, false),
        Quiz("quiz-py-hard2", "python", "Python: глубокое погружение", "yield, дескрипторы, is vs ==", Difficulty.HARD, listOf("q83","q86","q88","q90"), 120, false),
        // Kotlin
        Quiz("quiz-kt-easy", "kotlin", "Kotlin: основы", "val/var, data class, map", Difficulty.EASY, listOf("q11","q12","q15","q18"), 60, false),
        Quiz("quiz-kt-mid", "kotlin", "Kotlin: средний", "sealed, extensions, coroutines", Difficulty.MEDIUM, listOf("q13","q14","q16","q17"), 90, false),
        Quiz("quiz-kt-hard", "kotlin", "Kotlin: продвинутый", "lazy, inline, null safety", Difficulty.HARD, listOf("q19","q20","q13","q16"), 120, false),
        Quiz("quiz-kt-easy2", "kotlin", "Kotlin: коллекции и scope", "filter, let, apply, Pair", Difficulty.EASY, listOf("q91","q92","q96","q97"), 60, false),
        Quiz("quiz-kt-hard2", "kotlin", "Kotlin: глубокое погружение", "reified, Sequence, delegation", Difficulty.HARD, listOf("q98","q99","q100","q95"), 120, false),
        // JavaScript
        Quiz("quiz-js-easy", "javascript", "JavaScript: основы", "let/var, typeof, ===", Difficulty.EASY, listOf("q21","q22","q26","q30"), 60, false),
        Quiz("quiz-js-mid", "javascript", "JavaScript: средний", "Promise, closure, async/await", Difficulty.MEDIUM, listOf("q23","q24","q25","q27","q29"), 90, false),
        Quiz("quiz-js-hard", "javascript", "JavaScript: продвинутый", "Event loop, hoisting, closure", Difficulty.HARD, listOf("q28","q23","q25","q27"), 120, false),
        Quiz("quiz-js-easy2", "javascript", "JavaScript: основы 2", "this, null/undefined, destructuring", Difficulty.EASY, listOf("q105","q107","q101","q109"), 60, false),
        Quiz("quiz-js-hard2", "javascript", "JavaScript: глубокое погружение", "prototype, event loop, WeakMap", Difficulty.HARD, listOf("q102","q103","q106","q108","q110"), 120, false),
        // SQL
        Quiz("quiz-sql-easy", "sql", "SQL: основы", "SELECT, JOIN, DISTINCT", Difficulty.EASY, listOf("q31","q32","q38"), 60, false),
        Quiz("quiz-sql-mid", "sql", "SQL: средний", "GROUP BY, HAVING, подзапросы", Difficulty.MEDIUM, listOf("q33","q34","q35","q36","q37"), 90, false),
        Quiz("quiz-sql-hard", "sql", "SQL: продвинутый", "Нормализация, транзакции", Difficulty.HARD, listOf("q39","q40","q36","q37"), 120, false),
        Quiz("quiz-sql-easy2", "sql", "SQL: основы 2", "PK, FK, CHAR/VARCHAR", Difficulty.EASY, listOf("q113","q115","q118","q38"), 60, false),
        Quiz("quiz-sql-hard2", "sql", "SQL: продвинутый 2", "UNION, VIEW, оконные функции", Difficulty.HARD, listOf("q111","q112","q117","q116"), 120, false),
        // Algorithms
        Quiz("quiz-algo-easy", "algorithms", "Алгоритмы: основы", "Big O, стек, массив", Difficulty.EASY, listOf("q41","q42","q43","q45","q50"), 60, false),
        Quiz("quiz-algo-mid", "algorithms", "Алгоритмы: средний", "Hash, merge sort, BFS", Difficulty.MEDIUM, listOf("q44","q46","q47","q49"), 90, false),
        Quiz("quiz-algo-hard", "algorithms", "Алгоритмы: продвинутый", "DP, Quick Sort", Difficulty.HARD, listOf("q48","q49","q46","q44"), 120, false),
        Quiz("quiz-algo-easy2", "algorithms", "Алгоритмы: основы 2", "Queue, linked list, пузырёк", Difficulty.EASY, listOf("q119","q124","q125","q126"), 60, false),
        Quiz("quiz-algo-mid2", "algorithms", "Алгоритмы: средний 2", "DFS, BST, жадный, мемоизация", Difficulty.MEDIUM, listOf("q121","q122","q123","q127"), 90, false),
        // OOP
        Quiz("quiz-oop", "oop", "ООП: принципы", "4 столпа, SOLID, DI", Difficulty.MEDIUM, listOf("q51","q52","q53","q54","q55","q56","q57"), 90, false),
        Quiz("quiz-oop-hard", "oop", "ООП: продвинутый", "SOLID, LSP, композиция", Difficulty.HARD, listOf("q55","q56","q57","q58"), 120, false),
        Quiz("quiz-oop-easy", "oop", "ООП: основы", "Overloading, overriding, множественное наследование", Difficulty.EASY, listOf("q51","q52","q54","q133","q134"), 60, false),
        Quiz("quiz-oop-solid", "oop", "ООП: SOLID полностью", "Все 5 принципов SOLID", Difficulty.HARD, listOf("q55","q129","q130","q131","q58"), 120, false),
        // Patterns
        Quiz("quiz-patterns", "patterns", "Паттерны: базовые", "Singleton, Observer, Factory, Builder", Difficulty.MEDIUM, listOf("q59","q60","q61","q63","q65"), 90, false),
        Quiz("quiz-patterns-adv", "patterns", "Паттерны: продвинутый", "Strategy, Decorator, MVC", Difficulty.HARD, listOf("q62","q64","q66","q60","q61"), 120, false),
        Quiz("quiz-patterns2", "patterns", "Паттерны: продвинутый 2", "Proxy, Facade, Command, State", Difficulty.HARD, listOf("q135","q136","q137","q138","q139","q140"), 120, false),
        // Git
        Quiz("quiz-git-easy", "git", "Git: основы", "add, stash, gitignore, PR", Difficulty.EASY, listOf("q67","q69","q72","q73"), 60, false),
        Quiz("quiz-git-mid", "git", "Git: средний", "merge vs rebase, cherry-pick", Difficulty.MEDIUM, listOf("q68","q70","q74"), 90, false),
        Quiz("quiz-git-hard", "git", "Git: продвинутый", "fetch, revert, tag, submodule", Difficulty.HARD, listOf("q142","q143","q145","q71"), 120, false),
        // System Design
        Quiz("quiz-sysdesign", "system_design", "System Design: основы", "Масштабирование, кэш, REST", Difficulty.MEDIUM, listOf("q75","q76","q78","q79","q80"), 90, false),
        Quiz("quiz-sysdesign-hard", "system_design", "System Design: продвинутый", "CAP, микросервисы", Difficulty.HARD, listOf("q77","q78","q79","q76"), 120, false),
        Quiz("quiz-sysdesign2", "system_design", "System Design: средний 2", "CDN, MQ, Gateway, WebSocket", Difficulty.MEDIUM, listOf("q147","q149","q150","q153"), 90, false),
        Quiz("quiz-sysdesign-hard2", "system_design", "System Design: хардкор", "Sharding, consistency, OAuth", Difficulty.HARD, listOf("q148","q152","q154","q77"), 120, false),
        // Daily
        Quiz("quiz-daily", "python", "Ежедневный челлендж", "Микс вопросов на сегодня", Difficulty.MEDIUM, listOf("q2","q13","q22","q34","q44","q51","q59","q67","q82","q96","q105","q119"), 45, true)
    ).map { QuizEntity.from(it) }
}
